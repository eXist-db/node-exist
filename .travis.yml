language: node_js

node_js:
  - "10"
  - "8"
  - "6"

services:
  - docker

env:
  - img=existdb/existdb:latest
  - img=existdb/existdb:release
  # - img= existdb/existdb:4.5.0
  - img=evolvedbinary/exist-db:eXist-3.6.1-minimal

notifications:
  email: false

before_install:
  - docker pull $img
  - docker create  --name exist-ci -p 8080:8080 $img
  - npm prune

install:
  - npm install -q

before_script:
  - docker start exist-ci
  # exist needs time
  - sleep 30

script:
  - npm test

after_success:
  - npm install -g travis-deploy-once
  - travis-deploy-once "npm run semantic-release"

# cache:
#   directories:
#     - ${HOME}/exist
